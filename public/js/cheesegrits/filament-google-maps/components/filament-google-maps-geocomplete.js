function G({setStateUsing:i,debug:_,statePath:r,gmaps:p,filterName:c,reverseGeocodeFields:d,latLngFields:m,types:y,countries:v,isLocation:h,placeField:s,reverseGeocodeUsing:w,hasReverseGeocodeUsing:g=!1,minChars:I,fieldId:L}){let u=document.getElementById(L);return{geocoder:null,mapEl:null,symbols:{"%n":["street_number"],"%z":["postal_code"],"%S":["street_address","route"],"%A1":["administrative_area_level_1"],"%A2":["administrative_area_level_2"],"%A3":["administrative_area_level_3"],"%A4":["administrative_area_level_4"],"%A5":["administrative_area_level_5"],"%a1":["administrative_area_level_1"],"%a2":["administrative_area_level_2"],"%a3":["administrative_area_level_3"],"%a4":["administrative_area_level_4"],"%a5":["administrative_area_level_5"],"%L":["locality","postal_town"],"%D":["sublocality"],"%C":["country"],"%c":["country"],"%p":["premise"],"%P":["premise"]},loadGMaps:function(){if(document.getElementById("filament-google-maps-google-maps-js")){let e=function(a,n){window[a]?n():setTimeout(function(){e(a,n)},100)};e("filamentGoogleMapsAPILoaded",function(){this.createAutocomplete()}.bind(this))}else{let e=document.createElement("script");e.id="filament-google-maps-google-maps-js",window.filamentGoogleMapsAsyncLoad=this.createAutocomplete.bind(this),e.src=p+"&callback=filamentGoogleMapsAsyncLoad",document.head.appendChild(e)}},init:function(e){console.log("geocomplete init"),this.mapEl=e,this.loadGMaps()},createAutocomplete:function(){window.filamentGoogleMapsAPILoaded=!0;let e=["address_components","formatted_address","geometry","name"];e.includes(s)||e.push(s);let a={fields:e,strictBounds:!1,types:y};if(u){window.addEventListener("keydown",function(t){if((t.key==="U+000A"||t.key==="Enter"||t.code==="Enter")&&t.target.nodeName==="INPUT"&&t.target.type==="text")return t.preventDefault(),!1},!0);let n=new google.maps.places.Autocomplete(u,a);n.setComponentRestrictions({country:v}),n.addListener("place_changed",()=>{let t=n.getPlace();if(!t.geometry||!t.geometry.location){window.alert("No details available for input: '"+t.name+"'");return}this.setLocation(t),this.updateReverseGeocode(t),this.updateLatLng(t)});let o=document.getElementById(r+"-geolocate");o&&(this.geocoder=new google.maps.Geocoder,o.addEventListener("click",t=>{"geolocation"in navigator&&navigator.geolocation.getCurrentPosition(f=>{var b=f.coords.latitude,A=f.coords.longitude,E={lat:b,lng:A};this.geocoder.geocode({location:E}).then(l=>{l.results[0]&&(u.setAttribute("value",l.results[0].formatted_address),this.setLocation(l.results[0]),this.updateReverseGeocode(l.results[0]),this.updateLatLng(l.results[0]))})})}))}},setLocation:async function(e){if(h?await i(r,{lat:e.geometry.location.lat(),lng:e.geometry.location.lng(),formatted_address:e[s]}):await i(r,e[s]),c){let a=c+".latitude",n=c+".longitude",o=document.getElementById(a),t=document.getElementById(n);o&&t&&(o.setAttribute("value",e.geometry.location.lat().toString()),t.setAttribute("value",e.geometry.location.lng().toString()),await i(a,e.geometry.location.lat().toString()),await i(n,e.geometry.location.lng().toString()))}},updateReverseGeocode:async function(e){if(this.hasReverseGeocode()){if(e.address_components){let a=this.getReplacements(e.address_components);for(let n in d){let o=d[n];for(let t in a)o=o.split(t).join(a[t]);for(let t in this.symbols)o=o.split(t).join("");o=o.trim(),await i(n,o)}}g&&w(e)}},updateLatLng:async function(e){Object.keys(m).length>0&&e.geometry&&(await i(m.lat,e.geometry.location.lat().toString()),await i(m.lng,e.geometry.location.lng().toString()))},getReplacements:function(e){let a={};return e.forEach(n=>{for(let o in this.symbols)this.symbols[o].indexOf(n.types[0])!==-1&&(o===o.toLowerCase()?a[o]=n.short_name:a[o]=n.long_name)}),_&&console.log(a),a},hasReverseGeocode:function(){return Object.keys(d).length>0||g}}}export{G as default};
